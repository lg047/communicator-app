<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <head>

  <!-- Open Graph tags for link previews -->
  <meta property="og:title" content="Tototype">
  <meta property="og:description" content="A simple speech interface for fast communication.">
  <meta property="og:image" content="https://tototype.com/preview.png">
  <meta property="og:url" content="https://tototype.com">
  <meta property="og:type" content="website">

  <link rel="icon" href="/tototype_icon_new.png" type="image/png">
  <title>TotoType</title>
  <style>
    html, body {
      margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden;
      background-color: #ffecec; /* light red while typing */
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    }
    #editor {
      width: 100%;
      /* reserve space below for controls and shortcuts */
      height: calc(100% - 60px);
      font-size: 6vw; line-height: 1.2;  /* default 2 sizes smaller */
      white-space: pre-wrap; /* preserves wrapping */
      overflow-wrap: break-word; word-break: break-word;
      outline: none; padding: 90px 200px; box-sizing: border-box;
      color: #000000;
      color: #000000;
    }
    #controls {
      position: fixed; bottom: 10px; right: 10px;
      background: rgba(255,255,255,0.7); padding: 5px; border-radius: 5px;
      display: flex; gap: 5px; z-index: 1000;
    }
    #controls button {
      font-size: 1rem; padding: 0.2em 0.5em; border: none;
      border-radius: 3px; cursor: pointer;
    }
    #shortcuts {
      position: fixed; bottom: 10px; left: 10px;
      background: rgba(255,255,255,0.6); padding: 4px 6px;
      border-radius: 4px; font-size: 0.8rem; color: #333333;
      pointer-events: none; z-index: 1000;
    }
  </style>
</head>
<body>
  <div id="editor" contenteditable="true" spellcheck="false"></div>
  <div id="controls">
    <button id="zoomOut">A-</button>
    <button id="zoomIn">A+</button>
  </div>
  <div id="shortcuts">
    Ctrl+Enter: Ready &nbsp;|&nbsp; Enter: New Line &nbsp;|&nbsp; Ctrl+Backspace: Clear &nbsp;|&nbsp; Ctrl + (+) / Ctrl + (-): Zoom
  </div>
  <script>
    const editor = document.getElementById('editor');
    const body = document.body;
    const zoomInBtn = document.getElementById('zoomIn');
    const zoomOutBtn = document.getElementById('zoomOut');
    const RED_BG = '#ffecec';
    const GREEN_BG = '#ecffec';
    let fontSizeVW = 6;  // two sizes smaller default

    // Apply font size to editor
    function setFontSize() {
      editor.style.fontSize = fontSizeVW + 'vw';
    }

    // Shrink font until content fits
    function adjustFontSizeToFit() {
      while (editor.scrollHeight > editor.clientHeight && fontSizeVW > 2) {
        fontSizeVW = Math.max(fontSizeVW - 0.5, 2);
        setFontSize();
      }
    }

    // Initialize
    setFontSize();

    // Manual zoom controls
    zoomInBtn.addEventListener('click', () => {
      fontSizeVW = Math.min(fontSizeVW + 1, 20);
      setFontSize();
      editor.focus();
    });
    zoomOutBtn.addEventListener('click', () => {
      fontSizeVW = Math.max(fontSizeVW - 1, 2);
      setFontSize();
      editor.focus();
    });

    // Handle typing: background reset and auto-shrink on overflow
    editor.addEventListener('input', () => {
      body.style.backgroundColor = RED_BG;
      if (editor.scrollHeight > editor.clientHeight) {
        adjustFontSizeToFit();
      }
    });

    document.addEventListener('keydown', (e) => {
      // Ctrl+Enter -> Ready state (light green)
      if (e.ctrlKey && e.key === 'Enter') {
        e.preventDefault();
        body.style.backgroundColor = GREEN_BG;
        editor.focus();
      }
      // Enter without Ctrl -> allow newline
      else if (e.key === 'Enter') {
        // Default behavior: newline in contenteditable
      }
      // Ctrl+Backspace -> Clear text, reset font size, and return to typing background
      if (e.ctrlKey && e.key === 'Backspace') {
        e.preventDefault();
        editor.focus();
        document.execCommand('selectAll', false, null);
        document.execCommand('delete', false, null);
        // Reset font size to default
        fontSizeVW = 6;
        setFontSize();
        body.style.backgroundColor = RED_BG;
      }
      // Zoom in via keyboard
      if (e.ctrlKey && (e.key === '+' || e.key === '=')) {
        e.preventDefault();
        fontSizeVW = Math.min(fontSizeVW + 1, 20);
        setFontSize();
      }
      // Zoom out via keyboard
      if (e.ctrlKey && e.key === '-') {
        e.preventDefault();
        fontSizeVW = Math.max(fontSizeVW - 1, 2);
        setFontSize();
      }
    });

    // Focus on load
    window.onload = () => editor.focus();
  </script>
</body>
</html>
